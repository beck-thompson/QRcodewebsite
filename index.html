<!DOCTYPE html>

<html>
  <head>
    <link rel="stylesheet" href="style.css">
        <script src="script.js" defer></script>
  </head>

  <body>
    <div class="content">
      <h2>
        How to decode QR codes by hand
      </h2>
      <div id="subtitle">It's easier than you'd think!</div>
      <div id="date"> June 11, 2022</div>

      <p>QR codes are everywhere! From ordering food to getting event info, I'm contstantly scanning these little black and white boxes. I've always thought they were extremely complex and only veteran programers could understand their inner workings.</p>
      <p>However, that <b> is not </b> true! They are actaully quite simple and hopefully, after reading this article, you will have a basic understanding of how they work.</p>

      <h3>What are QR codes?</h3>

      <p>Usually they are just links to websites.<p>

      <h3>QR code "zones"</h3>
      <p>Before you can decode QR codes you have to know the different parts of a QR code.<p>
      <p>QR codes contain 3 "zones":</p>
      <ul>
        <li style="color: PaleVioletRed;">Camera alignment</li> (Including timing belts MAKE COLOR)
        <li style="color: blue;">Formating data</li>
        <li style="color: green;">Data</li>
      </ul>

      <div style="display: inline-block;">
        <div style="border-style: solid;border-color: gray;border-width: 0px; float:left; margin-right: 50px;">
          <canvas width = "420" height = "420" id="canvas"></canvas>
        </div>

        <div style="border-style: solid; border-color: black; border-width: 2px; float:right; display:block; padding-right:3px;">

          <div>
          <input type="checkbox" class="checkbox1" id="grid" checked>
          <label>Grid</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="camera_alignment">
          <label style="color:MediumVioletRed;">Camera alignment</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="formating_data">
          <label style="color:blue;">Formating data</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="data">
          <label style="color:green;">Data</label>
          </div>

        </div>

      </div>
CAHNGE TO ORANGE TIMING BELTS
      <p>The names are mostly self explanatory;</p>
      <p>The <a style="color:MediumVioletRed;"><b>camera alignment</b></a> section is for helping cameras align the QR code correctly.</p>
      <p>The <a style="color:blue;"><b>formating data</b></a> section contains general formating information for the QR code. This includes the error correction level, mask pattern and the "Dark Module" (See purple square in the QR code diagram above)!</p>
      <p>The <a style="color:green;"><b>data</b></a> section contains the actual data (Usually a hyperlink) and all error correction parity data.</p>
      <p>I will go over all these sections in detail.</p>

      <h3><a style="color:MediumVioletRed">Camera alignment</a></h3>
      <p>The camera alignment zone only has two parts:</p>
      <ul>
        <li style="color: red;">Position squares</li>
        <li style="color: orange;">Timing belts</li>
      </ul>
      <p>Both of these exist so cameras can align the QR code properly in order for the data to be easily read. The <a style="color:pink;">position squares</a> (Shown in pink in the diagram above) are on 3 corners of the QR code. Note that the bottom right doesn't contain a position square COLOR. This helps the camera know which way is is oriented.</p>

      <p>The timing belts (Shown in orange in the diagram above) connect each position square COLOR and always alternate between black and white pixels.</p>
      <img src="timing_belt.png" alt="Timing belt!">

      <h3>Formating data</h3>
      <p>The formating data is stored next to the camera alignment boxes. This data is:</p>
      <ul>
        <li style="color: blue;">Error correction format <a style="color:black;"><b>[0-9]  </b></a></li>
        <li style="color: Lime;">Mask pattern            <a style="color:black;"><b>[10-11]</b></a></li>
        <li style="color: red;">Error correction level   <a style="color:black;"><b>[13-14]</b></a></li>
        <li style="color: purple;">The "Dark Module"     <a style="color:black;"><b>[]</b></a></li>
      </ul>
      <p>All data is duplicated for redundency. If a square has the same number it is an exact copy in both positions!</b></p>
      <div style="display: inline-block;">
        <div style="border-style: solid;border-color: gray;border-width: 0px; float:left; margin-right: 50px;">
          <canvas width = "420" height = "420" id="canvas2"></canvas>
        </div>

        <div style="border-style: solid; border-color: black; border-width: 2px; float:right; display:block; padding-right:3px;">

          <div>
          <input type="checkbox" class="checkbox1" id="grid2" checked>
          <label>Grid</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="camera_alignment2">
          <label style="color:MediumVioletRed;">Camera alignment</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="formating_data2">
          <label style="color:blue;">Formating data</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="data2">
          <label style="color:green;">Data</label>
          </div>

        </div>
      </div>
      <p>The math behind the error correction COLOR is too complicated and mostly not important (Especially for humans!) so I'm not going to give a detailed explanation.</p>

      <p>However, the <a style="color:Lime;"><b>mask pattern</b></a> <i>is</i> needed to properly decode the data.</p>
      <p>A mask is used to make the data less "organized" and easier to read. Its easiest to show this with a picture! Can you tell how many boxes wide this is?</p>
      <img src="mask_1.png">
      <p>Its kind of hard! There is no way to tell where one square ends and the next begins. Now try this:</p>
      <img src="mask_3.png">
      <p>Much easier! Whenever you create a QR code there is an algorithm that chooses a mask pattern which minimizes the amount of continuous colors.</p>
      <p>In the case above, I used mask pattern <b>black white black</b> (101 in binary) which flips every other box to the opposite color. The picture below shows which ones were flipped to follow that mask pattern (F means the box was flipped):</p>
      <img src="mask_2.png">
      <p>There are 8 total mask patterns that you can apply to a QR code. The three lime green boxes indicate which one to use. Once you figure out which mask pattern is being used you just have to overlay the <a style="color:green;"><b>data</b></a> section with it! Everytime the mask pattern has a black box, you flip the color of the box below it.</p>

      <img src="masks.png" alt="Masks!">

      <p>The animation below shows the process of umasking the QR code. In this case the mask is still <b>black white black</b> (101 in binary) so we just flip every other <a style="color:green;"><b>data</b></a> box (Igore all <a style="color:MediumVioletRed;"><b>camera alignment</b></a> and <a style="color:blue;"><b>formating data</b></a> sections)! </p>
      <p>First, it goes over every single <a style="color:MediumVioletRed;"><b>data</b></a> square and puts an "F" where It needs to flip. It then flips all the "F" squares.</p>
      <button id = "animationstartbutton" type="button">Click to start animation!</button>
      <p></p>

      <div style="display: inline-block;">
        <div style="border-style: solid;border-color: gray;border-width: 0px; float:left; margin-right: 50px;">
          <canvas width = "420" height = "420" id="canvas3"></canvas>
        </div>

        <div style="border-style: solid; border-color: black; border-width: 2px; float:right; display:block; padding-right:3px;">

          <div>
          <input type="checkbox" class="checkbox1" id="grid3" checked>
          <label>Grid</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="camera_alignment3">
          <label style="color:MediumVioletRed;">Camera alignment</label>
          </div>

          <div>
            <div>Speed:</div>
            <input id = "speedslider" type="range" min="50" max="1000" value="500">
          </div>

        </div>
      </div>
      <p>ADD TOGGLE TO TURN ON AND OFF NUMBERS!</p>
      <p> MAKE A BETTER VERSON OF THIS. Show where to find the mask pattern again and also talk about skipping the timing belts. </p>
      <p> Also add picture alightment color and format data colors </p>

      <h3>Reading the data</h3>

      <p>We have now unmasked the data! All there is left to do is to read the data itself.</p>
      <p>I've made a graphical representation of the data below.</p>

      <ul style="background: Cornsilk;">
        <li style="color: CornflowerBlue;">Data encoding <a style="color:black;"><b>[1]  </b></a></li>
        <li style="color: Crimson;">Length            <a style="color:black;"><b>[2]</b></a></li>
        <li style="color: ForestGreen;">Data (Characters)  <a style="color:black;"><b>[3-6]</b> * </a></li>
        <li style="color: DarkMagenta;">End of data     <a style="color:black;"><b>[7]</b></a></li>
        <li style="color: Coral;">Error correction     <a style="color:black;"><b>[8]</b></a></li>
        <i>* All shades of green are characters. They are different colors to differencate themselves.</i>
      </ul>
      <p>FIX FORMATING DATA ERROR. ANIMATION ALSO DOES INCORRRECTLY DUE TO LAZY LOOPS. <b>GO TO SOURCE!!!!</b><p>

      <div style="display: inline-block;">
        <div style="border-style: solid;border-color: gray;border-width: 0px; float:left; margin-right: 50px;">
          <canvas width = "420" height = "420" id="canvas4"></canvas>
        </div>

        <div style="border-style: solid; border-color: black; border-width: 2px; float:right; display:block; padding-right:3px;">

          <div>
          <input type="checkbox" class="checkbox1" id="grid4" checked>
          <label>Grid</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="camera_alignment4">
          <label style="color:MediumVioletRed;">Camera alignment</label>
          </div>

          <div>
          <input type="checkbox" class="checkbox1" id="formating_data4">
          <label style="color:blue;">Formating data</label>
          </div>

          <div>
          <input onclick="
            allcheckboxesbelow = document.querySelectorAll('.numberstuff')
            thisbox = document.querySelectorAll('#data4')[0]

            function checkbox(item, index) {
              item.checked = thisbox.checked
            }
            allcheckboxesbelow.forEach(checkbox)
          "

          type="checkbox" class="checkbox1" id="data4">
          <label style="color:green;">Data</label>
          </div>

          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="nine" checked>
          <label style="color:black;">1</label>
          </div>
          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="ten" checked>
          <label style="color:black;">2</label>
          </div>
          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="eleven" checked>
          <label style="color:black;">3</label>
          </div>
          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="twelve" checked>
          <label style="color:black;">4</label>
          </div>
          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="thirteen" checked>
          <label style="color:black;">5</label>
          </div>
          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="fourteen" checked>
          <label style="color:black;">6</label>
          </div>
          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="fifteen" checked>
          <label style="color:black;">7</label>
          </div>
          <div style="margin-left:20px;">
          <input type="checkbox" class="numberstuff" id="sixteen" checked>
          <label style="color:black;">8</label>
          </div>

        </div>


      </div>

      <h3>Understaning the sections</h3>
      <p>The first section, <a style="color:cornflowerblue;"><b>data encoding</b></a> is simple! <a style="color:cornflowerblue;"><b>Data encoding</b></a> is how and what data is being stored. Because you can store URLS, letters, numbers and much more in QR codes these 4 pixels tell what is in the given QR code!</p>
      <p><a style="color:crimson;"><b>Length</b></a> is just the length (In 8 square sections) of the data! In our case (length 4), the length indicates how many letters are being stored but depending on what is encoded it might not exactly match up.</p>
      <p><a style="color:ForestGreen;"><b>Characters / data</b></a> are by far the most important parts of the QR code. These sections contain the letters or numbers that the QR code is storing. In our case, the four sections <b>[3-6]</b>, contain the letters "w","i","k" and "i"!</p>
      <p>The last important section is the <a style="color:darkmagenta;"><b>end of data</b></a> box. This will always be four white squares (After unmasking) and just indicates where the <a style="color:forestgreen;"><b>data</b></a> ends and the <a style="color:coral;"><b>error correction</b></a> starts. </p>
      <p><a style="color:coral;"><b>Error correction</b></a> is too complex for this page and, again, is mostly useless for humans so I will skip it! Wikipeda has an article here [ADD LINK] if you want to learn more.</p>
      <h3>Reading the squares</h3>
      <p>Now that we know what seach section represents we need to be able to actually read them! I will skip the encoding section as it is isn't useful for decoding URLs or text.</p>
      <p>To read the squares simply use this diagram below. Technically all the squares are binary (Black is 1 and white is 0) but the diagram below is what we are going to use on this page. [FIX THIS]</p>
      <img src="diagram.png"></img>
      <p>All you do is add up the numbers where there is a black square. For the first  <a style="color:ForestGreen;"><b>data</b> </a> section (<b>3</b>) the answer is just 1 + 2 + 4 + 16 + 32 + 64 = <b>119</b> (Remember, ignore all the white squares!)</p>
      <img src="upexample.png"></img>
      <p>Now that we have the number associated with the letter we use this table to find what letter it is!</p>
      <img src="table.png"></img>
      <p><b>119</b> is "w" which is correct!</p>
      <p>Lets do the second character next (4). Because this one is sideways, and going from up to down, we must use the correct diagram (Up to Down).</p>
      <p>1 + 8 + 32 + 64 = 105 which is "i" in the table and the correct letter.</p>
      <img src="uptodownexample.png"></img>


    </div>
  </body>

</html>
